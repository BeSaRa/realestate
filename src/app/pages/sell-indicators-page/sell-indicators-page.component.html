<ng-container appExtraHeaderPortal [extraHeaderSubTitle]="lang.map.real_estate_sell_indicators"> </ng-container>

<div class="content-wrapper">
  <div class="p-3 lg:px-16">
    <app-transactions-filter
      indicatorType="sell"
      [municipalities]="municipalities"
      [propertyTypes]="propertyTypes"
      [propertyUsages]="propertyUsages"
      [areas]="areas"
      [paramsRange]="paramsRange"
      (fromChanged)="filterChange($event)" />
  </div>

  <div class="flex flex-col">
    <div class="px-3 lg:px-16 mt-5 flex justify-center">
      <div class="flex justify-center gap-2 lg:gap-5 w-full md:w-3/4 lg:w-2/3 text-lg sm:text-2xl">
        <button
          [ngClass]="{ active: isSelectedTab('sell_indicators') }"
          (click)="switchTab('sell_indicators')"
          class="flex-1 shadow-xl outline-none border border-secondary font-semibold px-2 py-3 lg:py-4 rounded-2xl [&.active]:bg-secondary [&.active]:text-white [&.active]:ring-2 ring-black">
          {{ lang.map.sell_indicators }}
        </button>
        <button
          [ngClass]="{ active: isSelectedTab('statistical_reports_for_sell') }"
          (click)="switchTab('statistical_reports_for_sell')"
          class="flex-1 shadow-xl outline-none border border-secondary font-semibold px-2 py-3 lg:py-4 rounded-2xl [&.active]:bg-secondary [&.active]:text-white [&.active]:ring-2 ring-black">
          {{ lang.map.statistical_reports_for_sell }}
        </button>
      </div>
    </div>
  </div>
  <div *ngIf="isSelectedTab('sell_indicators')" class="flex flex-col">
    <div *appSectionGuard="pageSections.SELL_ROOT_KPIS" class="py-16 px-3 lg:px-16">
      <div class="flex flex-col">
        <h3
          class="heading text-xl sm:text-2xl md:text-3xl self-center md:self-start text-center text-primary border-secondary font-semibold">
          {{ lang.map.sell_transactions_measuring_dashboard }} {{ getStringSelectedCriteria() }}
        </h3>
        <div class="flex flex-col gap-4 xl:flex-row">
          <div
            class="flex-1 my-4 p-4 border border-secondary rounded-lg grid grid-cols-1 md:grid-cols-3 justify-center gap-4">
            <app-kpi-root
              [criteria]="criteria.criteria"
              (itemSelected)="rootItemSelected($event)"
              *ngFor="let item of nonePriceList"
              [item]="item" />
          </div>
          <div
            class="flex-1 my-4 p-4 border border-secondary rounded-lg grid grid-cols-1 md:grid-cols-3 justify-center gap-4">
            <app-kpi-root
              [criteria]="criteria.criteria"
              (itemSelected)="rootItemSelected($event)"
              *ngFor="let item of priceList"
              [item]="item" />
          </div>
        </div>
      </div>
    </div>
    <div class="bg-sand py-16 px-3 lg:px-16">
      <div class="flex flex-col justify-center items-center">
        <ng-container *appSectionGuard="pageSections.SELL_PURPOSE_KPIS">
          <h3
            *ngIf="selectedRoot"
            class="heading text-xl sm:text-2xl md:text-3xl self-center text-center text-primary border-secondary font-semibold">
            {{ selectedRoot.getNames() }} ({{ lang.map.depending_on_use }}) {{ getStringSelectedCriteria() }}
          </h3>

          <div class="mt-4 sm:hidden w-full grid grid-cols-2 gap-2 overflow-hidden">
            <ng-container *ngFor="let item of purposeKPIS; let i = index">
              <app-purpose
                [item]="item"
                (click)="purposeSelected(item)"
                class="border-2 rounded-xl overflow-hidden xl:border-0 xl:rounded-none xl:border-e-2 border-secondary xl:last-of-type:border-e-0" />
            </ng-container>
          </div>
          <div
            class="mt-4 w-full hidden sm:grid grid-cols-3 xl:grid-cols-6 border-2 border-secondary overflow-hidden rounded-xl">
            <app-purpose
              *ngFor="let item of purposeKPIS; let i = index"
              [item]="item"
              (click)="purposeSelected(item)"
              class="xl:border-e-2 border-secondary last-of-type:border-e-0 {{
                i > 2 ? 'border-t-2 xl:border-t-0' : ''
              }} {{ i % 3 === 2 ? 'border-e-0 xl:border-e-2' : 'border-e-2' }}" />
          </div>
        </ng-container>
        <ng-container *appSectionGuard="pageSections.SELL_PROPERTY_TYPE_KPIS">
          <h3
            *ngIf="selectedRoot"
            class="heading mt-20 text-xl sm:text-2xl md:text-3xl self-center text-center text-primary border-secondary font-semibold">
            {{ selectedRoot.getNames() }} ({{ lang.map.depending_on_type }}) {{ getStringSelectedCriteria() }}
          </h3>
          <div class="mt-4 w-full sm:w-5/6 lg:w-11/12" dir="ltr">
            <app-property-carousel
              [properties]="propertiesKPIS"
              useAssetsFrom="sell"
              [ignoreLocalImages]="true"></app-property-carousel></div
        ></ng-container>
      </div>
    </div>

    <div *appSectionGuard="pageSections.SELL_DURATION_CHART" class="py-16 px-3 lg:px-16">
      <app-duration-chart
        (isMonthltyDurationTypeEvent)="isMonthlyDurationType($event)"
        [title]="selectedRoot.getNames() + ' ' + getStringSelectedCriteria(true, isMonthlyDuration)"
        [name]="selectedRoot.getNames()"
        [criteria]="criteria.criteria"
        [rootData]="selectedRoot"></app-duration-chart>
    </div>
    <div *appSectionGuard="pageSections.SELL_TRANSACTIONS_TABLE.name" class="px-3 lg:px-16 flex flex-col gap-4">
      <h3
        class="heading text-xl sm:text-2xl md:text-3xl self-center md:self-start text-center text-primary border-secondary font-semibold">
        {{ lang.map.sell_transactions_list }} {{ getStringSelectedCriteria() }}
      </h3>

      <app-table
        [criteria]="criteria.criteria"
        [dataLoadFn]="transactionsLoadFn"
        [sortOptions]="[]"
        [tableGuardName]="pageSections.SELL_TRANSACTIONS_TABLE.name"
        minWidth="900px"
        headerBgColor="!bg-secondary">
        <ng-container appTableColumnTemplate [columnName]="pageSections.SELL_TRANSACTIONS_TABLE.columns.LOCATION">
          <div *appTableColumnHeaderTemplate class="flex justify-center">
            <div class="text-start">
              <p>{{ lang.map.location }}</p>
              <!-- <p class="font-normal">{{ lang.map.real_estate_status }}</p> -->
            </div>
          </div>
          <div *appTableColumnCellTemplate="let item; dataType: getTransactionType()" class="flex justify-center">
            <div class="text-center">
              <p class="font-bold">{{ (item.municipalityInfo && item.municipalityInfo.getNames()) || "---" }}</p>
              <p>{{ (item.areaInfo && item.areaInfo.getNames()) || "---" }}</p>
            </div>
          </div>
        </ng-container>
        <ng-container appTableColumnTemplate [columnName]="pageSections.SELL_TRANSACTIONS_TABLE.columns.SOLD_FOR">
          <span *appTableColumnHeaderTemplate>{{ lang.map.sold_for }}</span>
          <span *appTableColumnCellTemplate="let item; dataType: getTransactionType()" class="font-bold">{{
            item.realEstateValue | number
          }}</span>
        </ng-container>
        <ng-container appTableColumnTemplate [columnName]="pageSections.SELL_TRANSACTIONS_TABLE.columns.AREA">
          <span *appTableColumnHeaderTemplate>{{
            unitsService.isMeterSelected() ? lang.map.area_in_square_meter : lang.map.area_in_square_foot
          }}</span>
          <span *appTableColumnCellTemplate="let item; dataType: getTransactionType()" class="font-bold">{{
            unitsService.isMeterSelected() ? item.realEstateMT : item.realEstateSQT
          }}</span>
        </ng-container>
        <ng-container appTableColumnTemplate [columnName]="pageSections.SELL_TRANSACTIONS_TABLE.columns.SQUARE_PRICE">
          <span *appTableColumnHeaderTemplate>{{
            unitsService.isMeterSelected() ? lang.map.the_square_meter_price : lang.map.the_square_foot_price
          }}</span>
          <span *appTableColumnCellTemplate="let item; dataType: getTransactionType()" class="font-bold">{{
            (unitsService.isMeterSelected() ? item.priceMT : item.priceSQ) | number : "1.0-0"
          }}</span>
        </ng-container>
        <ng-container appTableColumnTemplate [columnName]="pageSections.SELL_TRANSACTIONS_TABLE.columns.ISSUE_DATE">
          <div *appTableColumnHeaderTemplate class="flex justify-center">
            <div class="text-start">
              <p>{{ lang.map.issue_date }}</p>
              <!-- Hide sold_by for now as client request Issue 60399 -->
              <!-- <p class="font-normal">{{ lang.map.sold_by }}</p> -->
            </div>
          </div>
          <div *appTableColumnCellTemplate="let item; dataType: getTransactionType()" class="text-center">
            <p>{{ item.issueDate | date : "YYYY-MM-dd" }}</p>
            <!-- Hide sold_by for now as client request Issue 60399 -->
            <!-- <p class="font-bold">{{ item.soldTo || "أفراد" }}</p> -->
          </div>
        </ng-container>

        <ng-container appTableColumnTemplate [columnName]="pageSections.SELL_TRANSACTIONS_TABLE.columns.ROI">
          <span *appTableColumnHeaderTemplate>ROI</span>
          <span *appTableColumnCellTemplate="let item; dataType: getTransactionType()" class="font-bold">{{
            item.roi === null ? "---" : (item.roi | percent : "1.2")
          }}</span>
        </ng-container>
        <!-- <ng-template appTableColumnTemplate columnName="area" [columnHeader]="lang.map.area" >
          <span class="font-bold">{{ item.area === null ? "---" : (item.area | number ) }}</span>
        </ng-template> -->
        <!-- <ng-template
          appTableColumnTemplate
          columnName="unit_parcel_no"
          [columnHeader]="lang.map.unit_parcel_no"
          let-item
          ><span class="font-bold">{{ item.unitNo ?? 13000 | number }}</span></ng-template
        > -->
      </app-table>
    </div>
  </div>
  <div></div>
  <div *ngIf="isSelectedTab('statistical_reports_for_sell')" class="flex flex-col">
    <!-- Temporarly hide forecasting chart -->
    <!-- <div *appSectionGuard="pageSections.SELL_FORECASTING_CHART" class="relative px-3 lg:px-16 flex flex-col justify-center items-center">
      <img
        class="absolute hidden sm:inline left-0 -bottom-16"
        src="assets/images/forecast-images/all-properties.svg"
        alt="" />
      <img class="absolute hidden sm:inline right-16 -bottom-14" src="assets/images/forecast-images/north.svg" alt="" />
      <img
        class="absolute hidden sm:inline right-0 -bottom-16"
        src="assets/images/forecast-images/north-big.svg"
        alt="" />

      <app-forecasting-chart
        [title]="lang.map.predicted_sell_price + ' ' + getStringSelectedCriteria(true, false)"
        [rootData]="{ chartDataUrl: urlService.URLS.SELL_KPI_ML, hasPrice: true }"
        [filterCriteria]="criteria.criteria"
        [criteriaTerms]="forecastCriteriaTerms"
        class="relative w-full md:w-5/6 lg:w-4/6 xl:w-7/12" />
    </div> -->

    <div
      *appSectionGuard="pageSections.SELL_PURPOSE_AND_TYPE_TABLE"
      class="px-3 lg:px-16 py-8 flex bg-sand mt-8 flex-col">
      <h3
        class="heading text-xl sm:text-2xl md:text-3xl self-center md:self-start text-center text-primary border-secondary font-semibold">
        {{ lang.map.sell_indicators }} {{ getStringSelectedCriteria() }}
      </h3>
      <div class="mt-4 flex justify-center md:justify-end">
        <div class="grid grid-cols-2 gap-2">
          <app-button
            (click)="updateSellIndicatorsTable(IndicatorsType.PURPOSE)"
            [buttonStyle]="selectedIndicators === IndicatorsType.PURPOSE ? 'secondary' : 'secondary-outline'"
            >{{ lang.map.depending_on_use }}</app-button
          >
          <app-button
            (click)="updateSellIndicatorsTable(IndicatorsType.TYPE)"
            [buttonStyle]="selectedIndicators === IndicatorsType.TYPE ? 'secondary' : 'secondary-outline'"
            >{{ lang.map.depending_on_type }}</app-button
          >
        </div>
      </div>
      <div class="overflow-x-auto">
        <table
          class="mt-5 custom-table w-full"
          [ngStyle]="{ minWidth: '1200px' }"
          mat-table
          matSort
          [dataSource]="transactionsStatisticsDatasource">
          <!-- purpose -->
          <ng-container matColumnDef="{{ transactionsStatisticsColumns[0] }}">
            <th
              mat-header-cell
              class="!text-white"
              mat-sort-header="{{ transactionsStatisticsColumns[0] }}"
              *matHeaderCellDef>
              {{ selectedIndicators === IndicatorsType.PURPOSE ? lang.map.purpose : lang.map.property_type }}
            </th>
            <td mat-cell *matCellDef="let element">
              {{ element.purposeInfo?.getNames() ?? element.propertyTypeInfo?.getNames() }}
            </td>
          </ng-container>

          <ng-container matColumnDef="average">
            <th mat-header-cell class="!text-white" mat-sort-header="average" *matHeaderCellDef>
              {{ lang.map.average_sell_price_per_unit_property }}
            </th>
            <td
              mat-cell
              *matCellDef="let element"
              appCustomTooltip
              [tooltipContent]="isPurposeOrTypeTermsValid ? null : tooltipTemplate"
              [tooltipContentContext]="purposeOrTypeTermsText">
              <ng-container *ngIf="isPurposeOrTypeTermsValid">{{ element.medianPrice | formatNumbers }}</ng-container>
              <ng-container *ngIf="!isPurposeOrTypeTermsValid"
                >"{{ lang.map.filter_values_must_be_modified_to_display_data }}"</ng-container
              >
            </td>
          </ng-container>
          <!-- count -->
          <ng-container matColumnDef="certificates-count">
            <th mat-header-cell class="!text-white" mat-sort-header="certificates-count" *matHeaderCellDef>
              {{ lang.map.number_of_sell_contracts }}
            </th>
            <td mat-cell *matCellDef="let element">{{ element.countCertificateCode | formatNumbers : 0 }}</td>
          </ng-container>

          <ng-container matColumnDef="area">
            <th mat-header-cell class="!text-white" mat-sort-header="area" *matHeaderCellDef>
              {{
                unitsService.isMeterSelected()
                  ? lang.map.total_area_in_square_meter
                  : lang.map.total_area_in_square_feet
              }}
            </th>
            <td mat-cell *matCellDef="let element">{{ element.sumArea | formatNumbers : 0 }}</td>
          </ng-container>

          <ng-container matColumnDef="units-count">
            <th mat-header-cell class="!text-white" mat-sort-header="units-count" *matHeaderCellDef>
              {{ lang.map.number_of_sold_units }}
            </th>
            <td mat-cell *matCellDef="let element">{{ element.countCertificateCode | formatNumbers : 0 }}</td>
          </ng-container>

          <ng-container matColumnDef="average-square">
            <th mat-header-cell class="!text-white" mat-sort-header="average-square" *matHeaderCellDef>
              {{
                unitsService.isMeterSelected()
                  ? lang.map.average_price_per_square_meter
                  : lang.map.average_price_per_square_foot
              }}
            </th>
            <td
              mat-cell
              appCustomTooltip
              [tooltipContent]="isPurposeOrTypeTermsValid ? null : tooltipTemplate"
              [tooltipContentContext]="purposeOrTypeTermsText"
              *matCellDef="let element">
              <ng-container *ngIf="isPurposeOrTypeTermsValid">{{
                element.unitSquareMedianPrice() | formatNumbers : 0
              }}</ng-container>
              <ng-container *ngIf="!isPurposeOrTypeTermsValid"
                >"{{ lang.map.filter_values_must_be_modified_to_display_data }}"</ng-container
              >
            </td>
          </ng-container>

          <!-- <ng-container matColumnDef="area">
          <th mat-header-cell class="!text-white" mat-sort-header="area" *matHeaderCellDef>
            {{ lang.map.total_area }}
          </th>
          <td mat-cell *matCellDef="let element">
            {{ element.totalArea ? (element.totalArea | formatNumbers : 0) : "---" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="count">
          <th mat-header-cell class="!text-white" mat-sort-header="count" *matHeaderCellDef>
            {{ lang.map.number_of_sell_contracts }}
          </th>
          <td mat-cell *matCellDef="let element">{{ element.countCertificateCode | formatNumbers : 0 }}</td>
        </ng-container>

        <ng-container matColumnDef="count">
          <th mat-header-cell class="!text-white" mat-sort-header="count" *matHeaderCellDef>
            {{ lang.map.number_of_sell_contracts }}
          </th>
          <td mat-cell *matCellDef="let element">{{ element.countCertificateCode | formatNumbers : 0 }}</td>
        </ng-container> -->
          <!-- count -->
          <ng-container matColumnDef="chart">
            <th mat-header-cell class="!text-white" *matHeaderCellDef>{{ lang.map.chart }}</th>
            <td
              appCustomTooltip
              [tooltipContent]="isPurposeOrTypeTermsValid ? null : tooltipTemplate"
              [tooltipContentContext]="purposeOrTypeTermsText"
              mat-cell
              *matCellDef="let element">
              <app-icon-button
                [disabled]="!isPurposeOrTypeTermsValid"
                (clicked)="openChart(element)"
                icon="BAR_CHART"></app-icon-button>
            </td>
          </ng-container>

          <tr
            mat-header-row
            class="rounded-first-tr !bg-secondary !text-white"
            *matHeaderRowDef="transactionsStatisticsColumns"></tr>
          <tr
            mat-row
            class="rounded-last-tr !bg-white"
            *matRowDef="let element; columns: transactionsStatisticsColumns"></tr>
          <!-- Row shown when there is no matching data. -->
          <tr class="mat-row" *matNoDataRow>
            <td class="p-4" colspan="100">{{ lang.map.no_records_to_display }}</td>
          </tr>
        </table>
      </div>
    </div>

    <div *appSectionGuard="pageSections.SELL_TOP_10_CHART" class="px-3 lg:px-16">
      <app-top-ten-chart
        [title]="lang.map.top_10_areas + ' ' + getStringSelectedCriteria(false)"
        [criteria]="criteria.criteria"
        [accordingToList]="accordingToList"
        [selectedAccordingTo]="accordingToList[0]"
        [bindLabel]="top10Label"></app-top-ten-chart>
    </div>

    <div *appSectionGuard="pageSections.SELL_COMPOSITE_TABLE" class="px-3 lg:px-16 bg-sand py-5">
      <div class="overflow-x-auto">
        <table
          class="custom-table p-5 w-full !bg-sand"
          [ngStyle]="{ minWidth: '1200px' }"
          mat-table
          matSort
          [dataSource]="compositeTransactions">
          <!-- arName -->
          <ng-container matColumnDef="municipality">
            <!--          mat-sort-header="municipality" -->
            <th mat-header-cell class="!bg-azure !text-white" *matHeaderCellDef>
              {{ lang.map.municipal }}
            </th>
            <td mat-cell *matCellDef="let element">{{ element[0].municipalityInfo.getNames() }}</td>
          </ng-container>

          <ng-container matColumnDef="firstYear1">
            <!--           mat-sort-header="firstYear1" -->
            <th mat-header-cell class="!bg-azure !text-white" *matHeaderCellDef>
              {{ compositeYears.previousYear }}
            </th>
            <td mat-cell *matCellDef="let element">{{ element[0].kpi1Val | formatNumbers }}</td>
          </ng-container>
          <ng-container matColumnDef="firstYear2">
            <!--          mat-sort-header="firstYear2" -->
            <th mat-header-cell class="!bg-azure !text-white" *matHeaderCellDef>
              {{ compositeYears.selectedYear }}
            </th>
            <td mat-cell *matCellDef="let element">{{ element[1].kpi1Val | formatNumbers }}</td>
          </ng-container>
          <ng-container matColumnDef="firstYoy">
            <!--          mat-sort-header="firstYoy" -->
            <th mat-header-cell class="!bg-azure !text-white" *matHeaderCellDef>{{ lang.map.change }} (YOY)</th>
            <td mat-cell *matCellDef="let element">
              <div class="flex gap-2 items-center">
                <app-yoy-indicator [value]="element[1].kpi1YoYVal.toFixed(2)" />
                <div>{{ element[1].kpi1YoYVal.toFixed(2) }} %</div>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="secondYear1">
            <!--          mat-sort-header="secondYear1" -->
            <th mat-header-cell class="!bg-jungle !text-white" *matHeaderCellDef>
              {{ compositeYears.previousYear }}
            </th>
            <td mat-cell *matCellDef="let element">{{ element[0].kpi2Val | formatNumbers }}</td>
          </ng-container>
          <ng-container matColumnDef="secondYear2">
            <!--          mat-sort-header="secondYear2" -->
            <th mat-header-cell class="!bg-jungle !text-white" *matHeaderCellDef>
              {{ compositeYears.selectedYear }}
            </th>
            <td mat-cell *matCellDef="let element">{{ element[1].kpi2Val | formatNumbers }}</td>
          </ng-container>
          <ng-container matColumnDef="secondYoy">
            <!--          mat-sort-header="secondYoy" -->
            <th mat-header-cell class="!bg-jungle !text-white" *matHeaderCellDef>{{ lang.map.change }} (YOY)</th>
            <td mat-cell *matCellDef="let element">
              <div class="flex gap-2 items-center">
                <app-yoy-indicator [value]="element[1].kpi2YoYVal.toFixed(2)" />
                <div>{{ element[1].kpi2YoYVal.toFixed(2) }} %</div>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="thirdYear1">
            <!--          mat-sort-header="thirdYear1" -->
            <th mat-header-cell class="!bg-indigo-rainbow !text-white" *matHeaderCellDef>
              {{ compositeYears.previousYear }}
            </th>
            <td
              [attr.colspan]="compositeAvgPriceCriteriaTerms.validate(criteria.criteria) ? 1 : 3"
              [ngClass]="{
                '!text-center !text-gray-400 !bg-slate-50': !compositeAvgPriceCriteriaTerms.validate(criteria.criteria)
              }"
              mat-cell
              *matCellDef="let element"
              appCustomTooltip
              [tooltipContent]="compositeAvgPriceCriteriaTerms.validate(criteria.criteria) ? null : tooltipTemplate"
              [tooltipContentContext]="compositeAvgPriceCriteriaTerms.getCriteriaTermsText()">
              <ng-container *ngIf="compositeAvgPriceCriteriaTerms.validate(criteria.criteria)">{{
                element[0].kpi3Val | formatNumbers
              }}</ng-container>
              <ng-container *ngIf="!compositeAvgPriceCriteriaTerms.validate(criteria.criteria)"
                >"{{ lang.map.filter_values_must_be_modified_to_display_data }}"</ng-container
              >
            </td>
          </ng-container>
          <ng-container matColumnDef="thirdYear2">
            <!--          mat-sort-header="thirdYear2" -->
            <th mat-header-cell class="!bg-indigo-rainbow !text-white" *matHeaderCellDef>
              {{ compositeYears.selectedYear }}
            </th>
            <td
              [ngClass]="{ hidden: !compositeAvgPriceCriteriaTerms.validate(criteria.criteria) }"
              mat-cell
              *matCellDef="let element">
              {{ element[1].kpi3Val | formatNumbers }}
            </td>
          </ng-container>
          <ng-container matColumnDef="thirdYoy">
            <!--          mat-sort-header="thirdYoy" -->
            <th mat-header-cell class="!bg-indigo-rainbow !text-white" *matHeaderCellDef>
              {{ lang.map.change }} (YOY)
            </th>
            <td
              [ngClass]="{ hidden: !compositeAvgPriceCriteriaTerms.validate(criteria.criteria) }"
              mat-cell
              *matCellDef="let element">
              <div class="flex gap-2 items-center">
                <app-yoy-indicator [value]="element[1].kpi3YoYVal.toFixed(2)" />
                <div>{{ element[1].kpi3YoYVal.toFixed(2) }} %</div>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="contractCounts">
            <th colspan="4" mat-header-cell *matHeaderCellDef>
              <div class="flex justify-center">
                <span class="text-azure text-2xl">{{ lang.map.sell_contracts_count }}</span>
              </div>
            </th>
          </ng-container>

          <ng-container matColumnDef="contractValues">
            <th colspan="3" mat-header-cell *matHeaderCellDef>
              <div class="flex justify-center">
                <span class="text-jungle text-2xl">{{ lang.map.sell_contracts_value }}</span>
              </div>
            </th>
          </ng-container>

          <ng-container matColumnDef="avgContract">
            <th colspan="3" mat-header-cell *matHeaderCellDef>
              <div class="flex justify-center">
                <span class="text-indigo-rainbow text-2xl">{{ lang.map.average_sell_price_per_unit_property }}</span>
              </div>
            </th>
          </ng-container>
          <tr mat-header-row class="[&>th]:border-none" *matHeaderRowDef="compositeTransactionsExtraColumns"></tr>
          <tr mat-header-row class="rounded-first-tr" *matHeaderRowDef="compositeTransactionsColumns"></tr>
          <tr
            mat-row
            class="rounded-last-tr !bg-white"
            *matRowDef="let element; columns: compositeTransactionsColumns"></tr>
          <!-- Row shown when there is no matching data. -->
          <tr class="mat-row" *matNoDataRow>
            <td class="p-4" colspan="100">{{ lang.map.no_records_to_display }}</td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>

<ng-template #tooltipTemplate let-terms>
  <div class="bg-black/80 text-white text-xs p-2 rounded-md">
    <p class="font-bold">{{ lang.map.filter_values_should_be_as_follows }}:</p>
    <p *ngFor="let term of terms">- {{ term }}</p>
  </div>
</ng-template>
