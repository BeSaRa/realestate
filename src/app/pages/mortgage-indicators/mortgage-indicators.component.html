<app-extra-header class="flex -mt-32 relative text-white text-center">
  <div class="h-60 flex flex-col justify-center" id="logo-side">
    <h1 class="text-5xl font-semibold">{{ lang.map.qatar_real_estate_platform }}</h1>
    <h2 class="text-3xl font-semibold">
      {{ lang.toggleMap.qatar_real_estate_platform }} -
      <span class="text-gray-400 font-normal">({{ lang.map.trial_run }})</span>
    </h2>
    <h2 class="mt-2 text-3xl font-semibold flex flex-col gap-3 items-center">
      <span class="w-32 h-[3px] bg-secondary"></span>
      <span class="text-white">{{ lang.map.real_estate_mortgage_indicators }}</span>
    </h2>
  </div>
</app-extra-header>
<div class="content-wrapper p-10">
  <div class="flex justify-center">
    <div class="flex flex-col w-3/4 gap-y-5">
      <h1 class="heading text-3xl self-start text-primary border-secondary font-semibold inline-block">
        {{ lang.map.mortgage_indicators }}
      </h1>
      <app-transactions-filter
        indicatorType="mortgage"
        [municipalities]="municipalities"
        (fromChanged)="filterChange($event)"
        [areas]="areas"
        [rooms]="rooms"
        [propertyTypes]="propertyTypes"
        [propertyUsages]="propertyUsage" />
      <div class="flex justify-center items-stretch [&>div]:w-80 gap-x-5">
        <div
          class="flex-1 my-4 p-4 border border-primary rounded-lg grid grid-cols-1 lg:grid-cols-3 justify-center gap-4">
          <app-kpi-root *ngFor="let item of rootKpis" [item]="item" />
        </div>
      </div>
      <div class="flex flex-col">
        <h1 class="heading text-3xl self-center text-primary border-secondary font-semibold inline-block">
          {{ lang.map.number_of_transactions }}
        </h1>
        <!--        <div class="flex">-->
        <!--          <div class="flex-auto"></div>-->
        <!--          <div class="grid grid-cols-4 gap-2">-->
        <!--            <app-button-->
        <!--              (click)="updateChartDuration(DurationTypes.YEARLY)"-->
        <!--              [buttonStyle]="transactionCountDuration === DurationTypes.YEARLY ? 'secondary' : 'secondary-outline'"-->
        <!--              [isRounded]="true"-->
        <!--              >{{ lang.map.yearly }}</app-button-->
        <!--            >-->
        <!--            <app-button-->
        <!--              (click)="updateChartDuration(DurationTypes.HALFY)"-->
        <!--              [buttonStyle]="transactionCountDuration === DurationTypes.HALFY ? 'secondary' : 'secondary-outline'"-->
        <!--              [isRounded]="true"-->
        <!--              >{{ lang.map.half_yearly }}</app-button-->
        <!--            >-->
        <!--            <app-button-->
        <!--              (click)="updateChartDuration(DurationTypes.QUARTERLY)"-->
        <!--              [buttonStyle]="transactionCountDuration === DurationTypes.QUARTERLY ? 'secondary' : 'secondary-outline'"-->
        <!--              [isRounded]="true"-->
        <!--              >{{ lang.map.quarter_yearly }}</app-button-->
        <!--            >-->
        <!--            <app-button-->
        <!--              (click)="updateChartDuration(DurationTypes.MONTHLY)"-->
        <!--              [buttonStyle]="transactionCountDuration === DurationTypes.MONTHLY ? 'secondary' : 'secondary-outline'"-->
        <!--              [isRounded]="true"-->
        <!--              >{{ lang.map.monthly }}</app-button-->
        <!--            >-->
        <!--          </div>-->
        <!--        </div>-->
        <div class="flex">
          <div dir="ltr" class="flex-auto">
            <apx-chart
              #chart
              [tooltip]="chartCountOptions.tooltip!"
              [colors]="chartCountOptions.colors!"
              [series]="chartCountOptions.series!"
              [chart]="chartCountOptions.chart!"
              [xaxis]="chartCountOptions.xaxis!"
              [dataLabels]="chartCountOptions.dataLabels!"
              [grid]="chartCountOptions.grid!"
              [stroke]="chartCountOptions.stroke!"
              [legend]="chartCountOptions.legend!"
              [plotOptions]="chartCountOptions.plotOptions!"
              [yaxis]="chartCountOptions.yaxis!"
              [title]="chartCountOptions.title!"></apx-chart>
          </div>
          <div class="h-full flex flex-col mt-10">
            <app-icon-button
              [ngClass]="{ 'text-primary': isSelectedChartType(ChartType.LINE, 'countChartType') }"
              (click)="updateChartType(ChartType.LINE, 'transactionCountChart', 'countChartType')"
              class="text-primary"
              icon="LINE_CHART" />
            <app-icon-button
              [ngClass]="{ 'text-primary': isSelectedChartType(ChartType.BAR, 'countChartType') }"
              (click)="updateChartType(ChartType.BAR, 'transactionCountChart', 'countChartType')"
              icon="BAR_CHART" />
            <app-icon-button
              [ngClass]="{ 'text-primary': isSelectedChartType(ChartType.AREA, 'countChartType') }"
              (click)="updateChartType(ChartType.AREA, 'transactionCountChart', 'countChartType')"
              icon="AREA_CHART" />
          </div>
        </div>
      </div>
      <div class="flex flex-col">
        <h1 class="heading text-3xl self-center text-primary border-secondary font-semibold inline-block">
          {{ lang.map.transactions_value }}
        </h1>
        <!--        <div class="flex">-->
        <!--          <div class="flex-auto"></div>-->
        <!--          <div class="grid grid-cols-4 gap-2">-->
        <!--            <app-button-->
        <!--              (click)="updateChartDuration(DurationTypes.YEARLY)"-->
        <!--              [buttonStyle]="transactionCountDuration === DurationTypes.YEARLY ? 'secondary' : 'secondary-outline'"-->
        <!--              [isRounded]="true"-->
        <!--              >{{ lang.map.yearly }}</app-button-->
        <!--            >-->
        <!--            <app-button-->
        <!--              (click)="updateChartDuration(DurationTypes.HALFY)"-->
        <!--              [buttonStyle]="transactionCountDuration === DurationTypes.HALFY ? 'secondary' : 'secondary-outline'"-->
        <!--              [isRounded]="true"-->
        <!--              >{{ lang.map.half_yearly }}</app-button-->
        <!--            >-->
        <!--            <app-button-->
        <!--              (click)="updateChartDuration(DurationTypes.QUARTERLY)"-->
        <!--              [buttonStyle]="transactionCountDuration === DurationTypes.QUARTERLY ? 'secondary' : 'secondary-outline'"-->
        <!--              [isRounded]="true"-->
        <!--              >{{ lang.map.quarter_yearly }}</app-button-->
        <!--            >-->
        <!--            <app-button-->
        <!--              (click)="updateChartDuration(DurationTypes.MONTHLY)"-->
        <!--              [buttonStyle]="transactionCountDuration === DurationTypes.MONTHLY ? 'secondary' : 'secondary-outline'"-->
        <!--              [isRounded]="true"-->
        <!--              >{{ lang.map.monthly }}</app-button-->
        <!--            >-->
        <!--          </div>-->
        <!--        </div>-->
        <div class="flex">
          <div dir="ltr" class="flex-auto">
            <apx-chart
              #chartValues
              [tooltip]="chartValueOptions.tooltip!"
              [colors]="chartValueOptions.colors!"
              [series]="chartValueOptions.series!"
              [chart]="chartValueOptions.chart!"
              [xaxis]="chartValueOptions.xaxis!"
              [dataLabels]="chartValueOptions.dataLabels!"
              [grid]="chartValueOptions.grid!"
              [stroke]="chartValueOptions.stroke!"
              [legend]="chartValueOptions.legend!"
              [plotOptions]="chartValueOptions.plotOptions!"
              [yaxis]="chartValueOptions.yaxis!"
              [title]="chartValueOptions.title!"></apx-chart>
          </div>
          <div class="h-full flex flex-col mt-10">
            <app-icon-button
              [ngClass]="{ 'text-primary': isSelectedChartType(ChartType.LINE, 'valueChartType') }"
              (click)="updateChartType(ChartType.LINE, 'transactionValueChart', 'valueChartType')"
              class="text-primary"
              icon="LINE_CHART" />
            <app-icon-button
              [ngClass]="{ 'text-primary': isSelectedChartType(ChartType.BAR, 'valueChartType') }"
              (click)="updateChartType(ChartType.BAR, 'transactionValueChart', 'valueChartType')"
              icon="BAR_CHART" />
            <app-icon-button
              [ngClass]="{ 'text-primary': isSelectedChartType(ChartType.AREA, 'valueChartType') }"
              (click)="updateChartType(ChartType.AREA, 'transactionValueChart', 'valueChartType')"
              icon="AREA_CHART" />
          </div>
        </div>
      </div>
      <div class="flex flex-col">
        <h1 class="heading text-3xl self-center mb-4 text-primary border-secondary font-semibold inline-block">
          {{ lang.map.mortgage_transactions_list }}
        </h1>
        <app-table
          minWidth="900px"
          headerBgColor="!bg-secondary"
          [data]="transactions"
          [sortOptions]="transactionsSortOptions"
          [defaultSortOption]="transactionsSortOptions[0]">
          <ng-container appTableColumnTemplate columnName="location">
            <div *appTableColumnHeaderTemplate class="flex justify-center">
              <div class="text-start">
                <p>{{ this.lang.map.location }}</p>
                <p class="font-normal">{{ this.lang.map.real_estate_status }}</p>
              </div>
            </div>
            <div *appTableColumnCellTemplate="let item; typeOf: transactions" class="flex justify-center">
              <div class="text-start">
                <p class="font-bold">{{ item.municipalityInfo.getNames() }}</p>
                <p>{{ item.areaInfo && item.areaInfo.getNames() && "---" }}</p>
              </div>
            </div>
          </ng-container>
          <ng-container appTableColumnTemplate columnName="mortgaged_for">
            <span *appTableColumnHeaderTemplate>{{ this.lang.map.mortgaged_for }}</span>
            <span *appTableColumnCellTemplate="let item; typeOf: transactions" class="font-bold">{{
              item.realEstateValue | number
            }}</span>
          </ng-container>
          <ng-container appTableColumnTemplate columnName="area_in_square_feet">
            <span *appTableColumnHeaderTemplate>{{ this.lang.map.area_in_square_foot }}</span>
            <span *appTableColumnCellTemplate="let item; typeOf: transactions" class="font-bold">---</span>
          </ng-container>
          <!-- <ng-container appTableColumnTemplate columnName="square_feet_price">
            <span *appTableColumnHeaderTemplate>{{ this.lang.map.square_feet_price }}</span>
            <span *appTableColumnCellTemplate="let item; typeOf: transactions" class="font-bold">{{
              item.priceMT | number : "1.0-0"
            }}</span>
          </ng-container> -->
          <ng-container appTableColumnTemplate columnName="issue_date">
            <div *appTableColumnHeaderTemplate class="flex justify-center">
              <div class="text-start">
                <p>{{ this.lang.map.issue_date }}</p>
                <p class="font-normal">{{ this.lang.map.sold_by }}</p>
              </div>
            </div>
            <div *appTableColumnCellTemplate="let item; typeOf: transactions" class="text-center">
              <p>{{ item.issueDate | date : "YYYY-MM-dd" }}</p>
              <p class="font-bold">{{ item.seller || "أفراد" }}</p>
            </div>
          </ng-container>
          <ng-container appTableColumnTemplate columnName="unit_parcel_no">
            <span *appTableColumnHeaderTemplate>{{ this.lang.map.unit_parcel_no }}</span>
            <span *appTableColumnCellTemplate="let item; typeOf: transactions" class="font-bold">{{
              item.unitNo | number
            }}</span>
          </ng-container>
          <!-- <ng-template appTableColumnTemplate columnName="area" [columnHeader]="lang.map.area" >
            <span class="font-bold">{{ item.area === null ? "---" : (item.area | number ) }}</span>
          </ng-template> -->
          <!-- <ng-template
            appTableColumnTemplate
            columnName="unit_parcel_no"
            [columnHeader]="this.lang.map.unit_parcel_no"
            let-item
            ><span class="font-bold">{{ item.unitNo ?? 13000 | number }}</span></ng-template
          > -->
        </app-table>
      </div>
    </div>
  </div>
</div>
